(function(i,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],n):(i=typeof globalThis<"u"?globalThis:i||self,n(i["use-simple-reducer"]={},i.react))})(this,function(i,n){"use strict";const b=()=>{const t=n.useRef(!0);return n.useEffect(()=>()=>{t.current=!1},[]),n.useCallback(s=>{t.current&&s&&s()},[])};function y(t){return t&&Object.prototype.toString.call(t)==="[object Promise]"}function P(t,r,s=n.useState){n.useEffect(()=>{y(t)&&t.then(e=>{h(e),d.current=e})},[]);const[a,h]=s(t),[c,f]=s({isActive:!1,runningAction:null,pendingActions:[]}),[R,m]=s(null),{current:u}=n.useRef([]),v=b(),l=n.useRef(!1),d=n.useRef(a),M={};for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(M[e]=(...o)=>{u.push({actionName:e,action:r[e],args:o}),f({...c,pendingActions:[...u]}),l.current||(l.current=!0,p())});function p(){const e=u.shift();e!==void 0?(f({...c,isActive:!0,runningAction:e,pendingActions:[...u]}),e.action(d.current,...e.args).then(o=>{v(()=>{d.current=o,m(null),h(o),p()})}).catch(o=>{v(()=>{const g=[...u];u.splice(0,u.length),l.current=!1,f({...c,isActive:!1,runningAction:null,pendingActions:[]}),m({reason:o,failedAction:e,pendingActions:g,runFailedAction:()=>A([e]),runPendingActions:()=>A(g),runAllActions:()=>A([e,...g])})})})):(l.current=!1,f({...c,isActive:!1,runningAction:null,pendingActions:[]}))}function A(e){u.push(...e),p()}return[a,M,c,R]}i.useSimpleReducer=P,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
